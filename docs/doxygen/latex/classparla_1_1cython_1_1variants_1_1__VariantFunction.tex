\hypertarget{classparla_1_1cython_1_1variants_1_1__VariantFunction}{}\doxysection{parla.\+cython.\+variants.\+\_\+\+Variant\+Function Class Reference}
\label{classparla_1_1cython_1_1variants_1_1__VariantFunction}\index{parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}}


Function wrapper that dispatches to different architecture targets.  




Inheritance diagram for parla.\+cython.\+variants.\+\_\+\+Variant\+Function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=203pt]{classparla_1_1cython_1_1variants_1_1__VariantFunction__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parla.\+cython.\+variants.\+\_\+\+Variant\+Function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=203pt]{classparla_1_1cython_1_1variants_1_1__VariantFunction__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{classparla_1_1cython_1_1variants_1_1__VariantFunction_ab6f7ceab7c3fbeceffbabca0e63c42e0}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, func)
\item 
def \mbox{\hyperlink{classparla_1_1cython_1_1variants_1_1__VariantFunction_ae3a355f6bb1dc128d32ed509ef5343f1}{variant}} (self, spec\+\_\+list, override=False)
\begin{DoxyCompactList}\small\item\em Decorator to declare a variant of this function for a specific architecture. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{classparla_1_1cython_1_1variants_1_1__VariantFunction_a8adac216b999d09a3cd9cb26ad8e2897}{get\+\_\+variant}} (self, spec\+\_\+key)
\begin{DoxyCompactList}\small\item\em Get the variant for a given specialization key. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{classparla_1_1cython_1_1variants_1_1__VariantFunction_a11379b0a7a0f6bec7762971a50af9d84}{\+\_\+\+\_\+repr\+\_\+\+\_\+}} (self)
\item 
def \mbox{\hyperlink{classparla_1_1cython_1_1variants_1_1__VariantFunction_a081b639e4ea9dc2de998e22057eaa594}{\+\_\+\+\_\+call\+\_\+\+\_\+}} (self, $\ast$args, $\ast$$\ast$kwargs)
\begin{DoxyCompactList}\small\item\em Call the function, dispatching to the appropriate variant. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classparla_1_1cython_1_1variants_1_1__VariantFunction_aa14008dc422359d731430adef4a03454}{\+\_\+default}}
\item 
\mbox{\hyperlink{classparla_1_1cython_1_1variants_1_1__VariantFunction_a2f8ebf9c54d4ed80bbfd00f0f07b914f}{\+\_\+variants}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Function wrapper that dispatches to different architecture targets. 

Specialization is only supported on the architecture level. Specifying specifications for specific devices (e.\+g. gpu(0) )is not supported. 

Definition at line 17 of file variants.\+pyx.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparla_1_1cython_1_1variants_1_1__VariantFunction_ab6f7ceab7c3fbeceffbabca0e63c42e0}\label{classparla_1_1cython_1_1variants_1_1__VariantFunction_ab6f7ceab7c3fbeceffbabca0e63c42e0}} 
\index{parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{func }\end{DoxyParamCaption})}



Definition at line 26 of file variants.\+pyx.


\begin{DoxyCode}{0}
\DoxyCodeLine{26     \textcolor{keyword}{def }\mbox{\hyperlink{namespaceparla_1_1cython_1_1core_abd75527c775e8a2eda6c2bd84fc0761a}{\_\_init\_\_}}(self, func):}
\DoxyCodeLine{27         self.\_default = func }
\DoxyCodeLine{28         self.\_variants = \{\}}
\DoxyCodeLine{29         functools.update\_wrapper(self, func)}
\DoxyCodeLine{30 }

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classparla_1_1cython_1_1variants_1_1__VariantFunction_a081b639e4ea9dc2de998e22057eaa594}\label{classparla_1_1cython_1_1variants_1_1__VariantFunction_a081b639e4ea9dc2de998e22057eaa594}} 
\index{parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}!\_\_call\_\_@{\_\_call\_\_}}
\index{\_\_call\_\_@{\_\_call\_\_}!parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}}
\doxysubsubsection{\texorpdfstring{\_\_call\_\_()}{\_\_call\_\_()}}
{\footnotesize\ttfamily def parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+\+\_\+call\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{$\ast$}]{args,  }\item[{$\ast$$\ast$}]{kwargs }\end{DoxyParamCaption})}



Call the function, dispatching to the appropriate variant. 



Definition at line 63 of file variants.\+pyx.


\begin{DoxyCode}{0}
\DoxyCodeLine{63     \textcolor{keyword}{def }\_\_call\_\_(self, *args, **kwargs):}
\DoxyCodeLine{64         \textcolor{stringliteral}{"{}"{}"{}!}}
\DoxyCodeLine{65 \textcolor{stringliteral}{        @brief Call the function, dispatching to the appropriate variant.}}
\DoxyCodeLine{66 \textcolor{stringliteral}{        "{}"{}"{}}}
\DoxyCodeLine{67         local\_context = Locals.context }
\DoxyCodeLine{68         local\_devices = local\_context.get\_all\_devices()}
\DoxyCodeLine{69 }
\DoxyCodeLine{70         \textcolor{keywordflow}{if} len(local\_devices) == 0:}
\DoxyCodeLine{71             \textcolor{keywordflow}{return} self.\_default(*args, **kwargs)}
\DoxyCodeLine{72 }
\DoxyCodeLine{73         \textcolor{comment}{\# Construct a architecture specialization key from the local devices.}}
\DoxyCodeLine{74         spec\_key = tuple([d.architecture \textcolor{keywordflow}{for} d \textcolor{keywordflow}{in} local\_devices])}
\DoxyCodeLine{75         \textcolor{comment}{\# If a single architecture variant type, it needs a single id, not a tuple.}}
\DoxyCodeLine{76         spec\_key = spec\_key[0] \textcolor{keywordflow}{if} len(spec\_key) == 1 \textcolor{keywordflow}{else} spec\_key}
\DoxyCodeLine{77 }
\DoxyCodeLine{78         \textcolor{comment}{\# Get the variant for the current specialization key.}}
\DoxyCodeLine{79         variant\_f = self.get\_variant(spec\_key)}
\DoxyCodeLine{80 }
\DoxyCodeLine{81         \textcolor{comment}{\# Call the variant.}}
\DoxyCodeLine{82         \textcolor{keywordflow}{return} variant\_f(*args, **kwargs)}
\DoxyCodeLine{83 }
\DoxyCodeLine{84 }

\end{DoxyCode}


References parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+default, and parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+get\+\_\+variant().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classparla_1_1cython_1_1variants_1_1__VariantFunction_a081b639e4ea9dc2de998e22057eaa594_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classparla_1_1cython_1_1variants_1_1__VariantFunction_a11379b0a7a0f6bec7762971a50af9d84}\label{classparla_1_1cython_1_1variants_1_1__VariantFunction_a11379b0a7a0f6bec7762971a50af9d84}} 
\index{parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}!\_\_repr\_\_@{\_\_repr\_\_}}
\index{\_\_repr\_\_@{\_\_repr\_\_}!parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}}
\doxysubsubsection{\texorpdfstring{\_\_repr\_\_()}{\_\_repr\_\_()}}
{\footnotesize\ttfamily def parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+\+\_\+repr\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 60 of file variants.\+pyx.


\begin{DoxyCode}{0}
\DoxyCodeLine{60     \textcolor{keyword}{def }\_\_repr\_\_(self):}
\DoxyCodeLine{61         \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}\{f\} specialized to \{targets\}>"{}}.format(f=repr(self.\_default)[:-\/1], targets=tuple(self.\_variants.\mbox{\hyperlink{namespaceparla_1_1cython_1_1tasks_a83206470aa63f6e6fb8614d30dcbbe74}{keys}}()))}
\DoxyCodeLine{62 }

\end{DoxyCode}


References parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+default, parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+variants, and parla.\+cython.\+tasks.\+keys.



Referenced by parla.\+common.\+globals.\+Storage.\+\_\+\+\_\+str\+\_\+\+\_\+(), parla.\+common.\+globals.\+Local\+Stack.\+\_\+\+\_\+str\+\_\+\+\_\+(), parla.\+cython.\+device.\+Stream.\+\_\+\+\_\+str\+\_\+\+\_\+(), and parla.\+cython.\+device.\+Cupy\+Stream.\+\_\+\+\_\+str\+\_\+\+\_\+().

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classparla_1_1cython_1_1variants_1_1__VariantFunction_a11379b0a7a0f6bec7762971a50af9d84_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classparla_1_1cython_1_1variants_1_1__VariantFunction_a8adac216b999d09a3cd9cb26ad8e2897}\label{classparla_1_1cython_1_1variants_1_1__VariantFunction_a8adac216b999d09a3cd9cb26ad8e2897}} 
\index{parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}!get\_variant@{get\_variant}}
\index{get\_variant@{get\_variant}!parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}}
\doxysubsubsection{\texorpdfstring{get\_variant()}{get\_variant()}}
{\footnotesize\ttfamily def parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+get\+\_\+variant (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{spec\+\_\+key }\end{DoxyParamCaption})}



Get the variant for a given specialization key. 



Definition at line 54 of file variants.\+pyx.


\begin{DoxyCode}{0}
\DoxyCodeLine{54     \textcolor{keyword}{def }get\_variant(self, spec\_key):}
\DoxyCodeLine{55         \textcolor{stringliteral}{"{}"{}"{}!}}
\DoxyCodeLine{56 \textcolor{stringliteral}{        @brief Get the variant for a given specialization key.}}
\DoxyCodeLine{57 \textcolor{stringliteral}{        "{}"{}"{}}}
\DoxyCodeLine{58         \textcolor{keywordflow}{return} self.\_variants.get(spec\_key, self.\_default)}
\DoxyCodeLine{59     }

\end{DoxyCode}


References parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+default, and parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+variants.



Referenced by parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+\+\_\+call\+\_\+\+\_\+().

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classparla_1_1cython_1_1variants_1_1__VariantFunction_a8adac216b999d09a3cd9cb26ad8e2897_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classparla_1_1cython_1_1variants_1_1__VariantFunction_ae3a355f6bb1dc128d32ed509ef5343f1}\label{classparla_1_1cython_1_1variants_1_1__VariantFunction_ae3a355f6bb1dc128d32ed509ef5343f1}} 
\index{parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}!variant@{variant}}
\index{variant@{variant}!parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}}
\doxysubsubsection{\texorpdfstring{variant()}{variant()}}
{\footnotesize\ttfamily def parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+variant (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{spec\+\_\+list,  }\item[{}]{override = {\ttfamily False} }\end{DoxyParamCaption})}



Decorator to declare a variant of this function for a specific architecture. 


\begin{DoxyParams}{Parameters}
{\em spec\+\_\+list} & A list of architectures to specialize this function for. Can be a single architecture, or a list of architectures. Each architecture can be a tuple of architectures to specialize for a multidevice configuration. \\
\hline
{\em override} & If true, allow overriding an existing variant for one of the given architectures. \\
\hline
\end{DoxyParams}


Definition at line 31 of file variants.\+pyx.


\begin{DoxyCode}{0}
\DoxyCodeLine{31     \textcolor{keyword}{def }variant(self, spec\_list, override=False):}
\DoxyCodeLine{32         \textcolor{stringliteral}{"{}"{}"{}!}}
\DoxyCodeLine{33 \textcolor{stringliteral}{        @brief Decorator to declare a variant of this function for a specific architecture.}}
\DoxyCodeLine{34 \textcolor{stringliteral}{}}
\DoxyCodeLine{35 \textcolor{stringliteral}{        @param spec\_list A list of architectures to specialize this function for. Can be a single architecture, or a list of architectures. Each architecture can be a tuple of architectures to specialize for a multidevice configuration.}}
\DoxyCodeLine{36 \textcolor{stringliteral}{        @param override If true, allow overriding an existing variant for one of the given architectures.}}
\DoxyCodeLine{37 \textcolor{stringliteral}{        "{}"{}"{}}}
\DoxyCodeLine{38 }
\DoxyCodeLine{39         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} isinstance(spec\_list, list):}
\DoxyCodeLine{40             spec\_list = [spec\_list]}
\DoxyCodeLine{41         }
\DoxyCodeLine{42         \textcolor{keywordflow}{if} any(t \textcolor{keywordflow}{in} self.\_variants \textcolor{keywordflow}{for} t \textcolor{keywordflow}{in} spec\_list) \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} override:}
\DoxyCodeLine{43             \textcolor{keywordflow}{raise} VariantDefinitionError(\textcolor{stringliteral}{"{}Variant already exists for one of the given specialization targets."{}})}
\DoxyCodeLine{44 }
\DoxyCodeLine{45         \textcolor{keyword}{def }variant(f):}
\DoxyCodeLine{46             \textcolor{keywordflow}{for} t \textcolor{keywordflow}{in} spec\_list:}
\DoxyCodeLine{47                 \textcolor{keyword}{assert} isinstance(t, PyArchitecture)}
\DoxyCodeLine{48                 self.\_variants[t.id] = f}
\DoxyCodeLine{49             \textcolor{keywordflow}{return} f}
\DoxyCodeLine{50         }
\DoxyCodeLine{51         variant.\_\_name\_\_ = \textcolor{stringliteral}{"{}\{\}.variant"{}}.format(self.\_default.\_\_name\_\_)}
\DoxyCodeLine{52         \textcolor{keywordflow}{return} variant}
\DoxyCodeLine{53 }

\end{DoxyCode}


References parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+default, and parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+variants.



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classparla_1_1cython_1_1variants_1_1__VariantFunction_aa14008dc422359d731430adef4a03454}\label{classparla_1_1cython_1_1variants_1_1__VariantFunction_aa14008dc422359d731430adef4a03454}} 
\index{parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}!\_default@{\_default}}
\index{\_default@{\_default}!parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}}
\doxysubsubsection{\texorpdfstring{\_default}{\_default}}
{\footnotesize\ttfamily parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+default\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 27 of file variants.\+pyx.



Referenced by parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+\+\_\+call\+\_\+\+\_\+(), parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+\+\_\+repr\+\_\+\+\_\+(), parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+get\+\_\+variant(), and parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+variant().

\mbox{\Hypertarget{classparla_1_1cython_1_1variants_1_1__VariantFunction_a2f8ebf9c54d4ed80bbfd00f0f07b914f}\label{classparla_1_1cython_1_1variants_1_1__VariantFunction_a2f8ebf9c54d4ed80bbfd00f0f07b914f}} 
\index{parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}!\_variants@{\_variants}}
\index{\_variants@{\_variants}!parla.cython.variants.\_VariantFunction@{parla.cython.variants.\_VariantFunction}}
\doxysubsubsection{\texorpdfstring{\_variants}{\_variants}}
{\footnotesize\ttfamily parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+variants\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 28 of file variants.\+pyx.



Referenced by parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+\_\+\+\_\+repr\+\_\+\+\_\+(), parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+get\+\_\+variant(), and parla.\+cython.\+variants.\+\_\+\+Variant\+Function.\+variant().



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/python/parla/cython/\mbox{\hyperlink{variants_8pyx}{variants.\+pyx}}\end{DoxyCompactItemize}
